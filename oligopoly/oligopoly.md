<a name="Top"> </a>

<h1>Oligopolistic Markets</h1>
<center><a href="#Game Theory">Game Theory</a>&nbsp;|&nbsp;<a href="#Linear Model & Complementarity">Linear Model & Complementarity</a>&nbsp;|&nbsp;<a href="#GAMS Model Definition">GAMS Model Definition</a></center><center><a href="#Input and Output Specification">Input and Output specification</a>&nbsp;|&nbsp;<a href="#GAMS Model">GAMS Model</a>&nbsp;|<a href="#References">References</a>&nbsp;</center>

<p>An oligopoly is a market form in which a market or industry is dominated by a small number of firms, known as oligopolists. In microeconomics, there are several canonical models to describe the outcomes of olgopolistic markets.  Here we describe mathematical formulations and an associated computable model for the <b>Cournot</b> model, <b>Bertrand</b> model and the <b>Stackelberg</b> model.</p>
<hr>
<p>The <b>Cournot</b> model was proposed by Antoine Cournot in 1838 to describe an oligopolistic market where firms strategically compete over quantities.  The model assumes that firms produce imperfect substitutes, firms have market power, there is no market entry and quantities are chosen simulataneously.  The simulataneous choice assumption does not refer to time but is meant to signify that no firm has knowledge of other firms' choice before they make their own.  In the canonical model all firms have full knowledge of the function that sets the common market price, their competitor's individual cost functions and the level demand.</p>
<hr>
<p>The <b>Bertrand</b> model was proposed by Joseph Bertrand in 1883 as a criticism to the Cournot Model.  The model describes an oligopoly where firms strategically compete over prices.  The model makes the same assumptions as the Cournot model.  Bertrand noted that firms do not generally change their production quantities to compete but change their product's price level.  While it is agreed that this more closely approximates the mechanism by which a firm would compete given the presented situation, the objective function is dis-continuous, the predictions are sensitive to tie breaking rules and other non-strategic assumptions and the model does not coincide with observation.</p>
<hr>
<p>The <b>Stackelberg</b> model was proposed by Heinrich Stackelberg in 1934 to describe an oligopoly where the market has a strategic (Stackelberg) leader.  This case is identical to the Cournot model, except that the Stackelberg leader sets their quantity first and the Stackelberg follower incorporates this information into their optimisation problem.  There is an additional assumption that the Stackelberg leader has commitment power.</p>
<a name="Game Theory"></a>
    <h1>Game Theory</h1>
<p>In 1951, John Nash introduced the solution concept of a Nash Equilibrium <b>(NE)</b> which states that all finite static games will have a stable equilibrium in mixed strategies <b>(MSNE)</b> determined by mutual best response.  The concept is intimately related to Cournot's best response dynamic for equilibrium solutions, but is extended to a much broader class of problem known as bimatrix games.  A zero-sum game is a special case of a bimatrix game, where one player's gain is another player's loss.  Zero-sum games can be solved as linear programming <b>(LP)</b> problems while bimatrix games are complementarity problems.  The NE concept has since been refined to Subgame Perfect Nash Equilibrium <b>(SPNE)</b>, which states that all finite dynamic (sequential) games will have a stable equilibrium if all information sets (decision nodes an agent can not distinguish between) contain a single decision node.  Strategies are SPNE if for every subgame the strategy specifies a NE of that subgame.  A subgame is specified by a decision node that all subsequent decision nodes are conditioned on.<br>
<b>Definiton</b> : <b>NE</b> by Best Response (<b>BR</b>)<br>
The action profile a<sub>i</sub><sup>*</sup> is a NE iff every player's action is a BR to the other player's actions a<sub>-i</sub><sup>*</sup> ,
<center>a<sub>i</sub><sup>*</sup> &isin; BR<sub>i</sub>(a<sub>-i</sub><sup>*</sup>)  &forall;  i .</center>
<b>Definiton</b> : <b>SPNE</b> by <b>BR</b><br>
The strategy profile s<sup>*</sup> which defines all actions taken in a dynamic game with perfect information is an SPNE if, for every player i, every history (possible set of past outcomes) after which player  i moves and every strategy s<sub>i</sub> the terminal history generated by s<sup>*</sup> is weakly preferred (at least as good) to the terminal histories generated by  s<sub>i</sub>, O<sub>h</sub>(s<sub>i</sub>,   s<sub>-i</sub><sup>*</sup>).  That is for utility u<sub>i</sub>,
<center>u<sub>i</sub>(O<sub>h</sub>(s<sup>*</sup>)) &ge; u<sub>i</sub>(O<sub>h</sub>(s<sub>i</sub>,  s<sub>-i</sub><sup>*</sup>))  &forall;  s<sub>i</sub>, i .</center>
We note that this states that at every proper subgame of the supergame all players play a NE action.  This clearly gives that all SPNE are NE.  We have that the Cournot and Bertrand games solutions are NE and the Stackelberg solution is an SPNE.  The proper subgames of the Stackelberg problem are the subgame corresponding to the leaders action and the subgame containing the simultaneous actions of the followers.</p>

<a name="Linear Model & Complementarity"></a>
    <h1>Linear Model of Oligopoly and Complementarity</h1>
<p>We consider a simple example of duopoly and complementarity to algebraicly and geometrically illustrate the simulartities and differences between our three models of oligopoly and how complementary conditions are related to their solution. <br>
Consider a market where competion over quantity occurs in a <b>Cournot</b> fashion and the total quantity produced is defined as, 
<center> <b>Q</b> = &#x2211;<sub>i</sub><sup>N</sup> q <sub>i</sub> </center>
Our linear inverse demand function, gives the common market price and given a consant 'a' is defined as, <br>
<center>p(<b>Q</b>) = a - <b>Q</b> ,   <b>Q</b> &le; a </center>
and 0 otherwise. Givne a common cost of production, 'c', we have the following profit function <br>
<center> &pi;<sub>i</sub> = p(<b>Q</b>)q<sub>i</sub> - cq<sub>i</sub> ,</center>
For the Cournot model we have that the firms simultaneously optimise the following non-linear problem, <br>
<center>max<sub>q<sub>i</sub></sub> &pi;(<b>Q</b>) = (a - <b>Q</b>)q<sub>i</sub> - cq<sub>i</sub> ,</center> 
<center>q<sub>i</sub> &ge; 0  &forall; i .</center> 
we have that the best response function of firm 'i' with respect to the quantity of all other firms (denoted as '-i'), BR<sub>i</sub>(q<sub>-i</sub>), which define the NE are calculated as follows, <br>
<center>BR<sub>i</sub>(q<sub>-i</sub>) &rarr; FOC = 0 = &part;{(a - q<sub>i</sub> - q<sub>-i</sub>)q<sub>i</sub> - cq<sub>i</sub>} </center>
<center>0 = a - c - q<sub>i</sub> - 2q<sub>i</sub></center>
<center>q<sub>i</sub> = BR<sub>i</sub>(q<sub>-i</sub>) = &frac12;(a - c - q<sub>-i</sub>)</center>
We now note that by symmetry we can drop the subscripts after taking our first order condition to calculate our best responses as follows,
<center> 0 = a - c - q - 2q ,</center>
<center>q = 1&frasl;3(a - c) .</center>
This describes our NE for the Cournot case, (q<sub>1</sub>, q<sub>2</sub>) = (1&frasl;3(a - c), 1&frasl;3(a - c)).</p> 

<p>We now consider a market where pricing follows <b>Bertrand</b> competition.  Specifically we have the following definiton of quantity produced for each firm,
<center>q<sub>i</sub>(p<sub>i</sub>, p<sub>-i</sub>) = [1 - p<sub>i</sub>; 0 ; &frac12;(1 - p<sub>i</sub>]</center>
for the case where [ p<sub>i</sub> < p<sub>-i</sub> ; p<sub>i</sub> > p<sub>-i</sub> ; p<sub>i</sub> = p<sub>-i</sub> ] respectively.  We again assume a common cost of production and define a firm's profit function as,
<center>&pi;<sub>i</sub> = q<sub>i</sub>(p<sub>i</sub> - c) ,</center>
We note that our function is discontinuous, so we can not take an FOC as in the Cournot case.   We state here that the unique NE of this problem is (p<sub>i</sub>, p<sub>-i</sub>) = (c, c).  There are a number of methods for solving this problem and we note that this model makes the perfect competition perdiction that firms earn zero profits by setting their prices to the cost of production.  This is known as the Bertrand paradox as it only takes two firms to create perfect competiton. <br>
We now refer back to the market defined oringially for the Cournot model.  We have the same market for our <b>Stackelberg</b> model, but we suppose that firm 1 (i = 1) is our Stackelberg-leader.  Here we analyze the game by backward induction, which we note provides a unique SPNE for dynamic games given there are no decision nodes after simultaneous decision stage. <br>
At time 2, firm 2 optimizes given firm 1's decision, q&#773;.  We therefore have the following optimisation problem for firm 2, <br>
<center>max<sub>q<sub>2</sub></sub> {(a - q&#773;<sub>1</sub> - q<sub>2</sub>)q<sub>2</sub> - cq<sub>2</sub>}</center>. Then the whole problem can be formulated as a <b>bilevel</b> problem:
<br><center>max<sub>q<sub>1</sub>,q<sub>2</sub></sub>{(a - q<sub>1</sub> - q<sub>2</sub><sup>*</sup>)q<sub>1</sub> - cq<sub>1</sub>}</center>
 <center> s.t. max<sub>q<sub>2</sub></sub> {(a - q&#773;<sub>1</sub> - q<sub>2</sub>)q<sub>2</sub> - cq<sub>2</sub>}</center>
<br>
We calculate the best response function as before,
<center>q<sub>2</sub><sup>*</sup> =  BR<sub>2</sub>(q&#773;<sub>1</sub>) = 1&frasl;2(a - c - q&#773;<sub>1</sub>)</center>
We then consider firm 1's maximisation problem at time 1 where they consider the fact that firm 2 optimises taking the choice of firm 1 as a constant,
<center>max<sub>q<sub>1</sub></sub> {(a - q<sub>1</sub> - q<sub>2</sub><sup>*</sup>)q<sub>1</sub> - cq<sub>1</sub>}</center>
<center>max<sub>q<sub>1</sub></sub> {(a - q<sub>1</sub> - 1&frasl;2(a - c - q&#773;<sub>1</sub>))q<sub>1</sub> - cq<sub>1</sub>}</center>
We once again optimise by setting our FOC to zero and solving.  We have,
<center>q<sub>1</sub><sup>*</sup> = q&#773;<sub>1</sub> = 1&frasl;2(a - c)</center>
We note here that this is the <b>monopoly</b> quantity from our Cournot model.  That is to say, firm 1 optimises as if they are the only firm in the market.  This is known as the first mover advantage which often arises when the follower has no <b>credible</b> threat, meaning there is no lower payoff NE which can be used to threaten the leader into a different action.  We solve for firm 2 by backward induction.
<center>q<sub>2</sub><sup>*</sup> = 1&frasl;2(a - c - 1&frasl;2(a - c))</center>
<center>= 1&frasl;4(a - c)</center>
Notice that this is one half the <b>monopoly</b> quantity from the Cournot case.
</p>
<p>
We now consider the following linear complementarity problem, <b>LCP(q, M)</b>.  Let M be a square matrix of order n, M &isin; R<sup>nxn</sup>, and q a column vector of length n, q &isin; R<sup>n</sup>.  We now define a complementary pair, w and z, where w &isin; R<sup>n</sup> and z &isin; R<sup>n</sup>.  In an LCP there is no objective function to be optimized.  The problem is: find z &isin; R<sup>n</sup> satisfying,
<center><b>LCP</b>(M,q) : w = Mz + q, z &ge; 0 , w &ge; 0, z'w = 0 .</center>
or equivalently,
<center>w = Mz + q, z &ge; 0 &perp; w &ge; 0 .</center>
LCP's arise in many different applications and are closely related to LP's and quadratic programs (QP's) because the KKT (Karush-Kuhn-Tucker) Conditions of these programs form LCP's.  Specifically we have that a QP forms an LCP of the above form by rewriting our QP as,
<center>z = [ x&#773; u&#773; ]' , M = [ Q -A' ; A 0 ] , q = [ p -b ]'</center>  
Where (;) denotes that it is a new row giving us a square matrix.  We have that a QP gives rises to an LCP by setting our Q = 0.  In this case, M is a skew symmetric matrix (M = -M'). <br> 
Our problem given the M and q above is denoted as an LCP of order n.  In an LCP of order n there are 2n variables to assign for satisficing complementarity.  As  an illustrative example we consider the following problem from Katta (2010 - online version).  Set M = [ 2 1 ; 1 2 ], q = [ -5 -6 ]'.  This problem can be explicitly written as,
<center>Iw - Mz = q ,</center>
<center>w, z &ge; 0 , w'z = 0 .</center>
where I is a 2x2 indentity matrix.  In the solution at least of the variables in each of the complementary pairs (z<sub>i</sub>, w<sub>i</sub>) must equal zero.  We pick w = 0 as our intial guess at a solution.  Our system has a solution iff the vector q can be expressed as a nonnegative combination of the vectors that compose the rows of the matrix M.  The set of nonnegative combinations of the vectors describe a complementary cone in the space q<sub>1</sub>, q<sub>2</sub> space.  Only if the vector q lies in the complementary cone then the LCP has a solution in which z<sub>1</sub>, z<sub>2</sub> are non-zero.  We have that q does lie in the cone and the combination (z<sub>1</sub>, z<sub>2</sub>) = (4&frasl;3, 7&frasl;3) is a solution.
</p>
<p>
We have tried to provide an accessible description of the models and some associated mathematics.  For some excellent treatments of the topics in this section we suggest the following sources.
<ul>
<li>Microeconomic Analysis by Hal Varian : Gives an in-depth treatment of the math of the oligopoly and a basic treatment of using KKT conditions for equilibrium</li>
<li> Linear Programming with MATLAB by M. Ferris, O. Mangasarian and S. Wright : Gives an excellent bottom up description of KKT conditions, complementarity conditions, LP, QP and LCP</li>
<li>Linear Complementarity, Linear and Nonlinear Programming by Katta Murty : Gives an intuitive and approachable description of everything to do with LCP</li>
<li> Population Games and Evolutionary Dynamics by William Sandholm : Gives an excellent, advanced description of the mathematics and geometry of equilibrium conditions</li>
</ul>
</p>

<a name="GAMS Model Definition"></a>

<h1>GAMS Model Definitions</h1></a>

<h3>Constant Elacticity of Substitution - Quantity Competition</h3>
<p>
Here we define our model for the Cournot and Stackelberg problems that we solve. The total quantity produced by the firms, <b>Q</b>, in the market are defined as,
<center> <b>Q</b> = &#x2211;<sub>i</sub><sup>N</sup> q <sub>i</sub> </center>
Our inverse demand function, p(<b>Q</b>), defines our market price at which all firms sell at and consumers purchase at.  The inverse demand function is derived from the demand curve, <b>Q</b>(p), defined as, <br>
<center><b>Q</b>(p) = (d&#773; / <b>Q</b>)<sup>1 / &gamma;</sup></center>
The total production cost, TC<sub>i</sub>(q<sub>i</sub>), for firm i.  Making a standard market assumption that the firm will be optimising when the marginal cost of a firm is equal to the price and assuming the firms supply curve is described by a Constant Elasticity of Substitution (CES) function, we have, <br>
<center>q<sub>i</sub> = L<sub>i</sub>p<sup>&beta;</sup></center>
which we note is a special case of CES known as the Cobb-Douglas function. We now have the folowing CES function describing total cost, <br>
<center>TC<sub>i</sub> = c<sub>i</sub>q<sub>i</sub> + &beta;<sub>i</sub> / (1 + &beta;<sub>i</sub>) * L<sub>i</sub><sup>1 / &beta;<sub>i</sub></sup> * q<sub>i</sub><sup>1 + &beta;<sub>i</sub> / &beta;<sub>i</sub></sup></center>
which the reader can verify gives our desired optimality condition p = MC.  Firms optimise their profit, &pi;, taking their own quantity and the quantities of the other firms have on the profit.  The profit function is defined as,
<center>&pi;<sub>i</sub> = q<sub>i</sub>p(<b>Q</b>) - TC<sub>i</sub> ,</center> 
Firms therefore optimise over the following non-linear problem (NLP), <br>
<center>max<sub>q<sub>i</sub></sub> &pi;(<b>Q</b>) = q<sub>i</sub>(d&#773; / <b>Q</b>)<sup>1 / &gamma;</sup> - c<sub>i</sub>q<sub>i</sub> + &beta;<sub>i</sub> / (1 + &beta;<sub>i</sub>) * L<sub>i</sub><sup>1 / &beta;<sub>i</sub></sup> * q<sub>i</sub><sup>1 + &beta;<sub>i</sub> / &beta;<sub>i</sub></sup></center>
<center>s.t. <b>Q</b> = &#x2211;<sub>i</sub><sup>N</sup> q <sub>i</sub></center>
<center> q<sub>i</sub> &ge; 0 .</center>
This is the standard formulation of oligopoly in microeconomics.  We execute a solution of the above problem for the Cournot and Stackelberg problem by complementarity.  We propose that the problem is a complementarity problem for all three cases but we execute a standard linear model (undergraduate economics) for the Bertrand case to avoid calibrating a benchmark formulae.</p>


<h3>Linear Weighting - Price Competition</h3>

<p>Here we define our model for the Bertrand problem that we solve. The total quantity produced by the firms is defined by a perturbed version of our previous linear model,
<center><b>Q</b> = &#x2211;<sub>i</sub><sup>N</sup> w<sub>i</sub>  q<sub>i</sub></center>
<center> w<sub>i</sub> &ne; w<sub>-i</sub></center>
We have the following demand function for each firm in the case of duopoly (for ease of exposition),
<center>q<sub>i</sub> = &alpha; - &delta;<sub>1</sub>p<sub>1</sub> + &delta;<sub>2</sub> p<sub>2</sub></center>
<center>&alpha; = ( w<sub>1</sub>d&#773; +  w<sub>2</sub>d&#773;  )/ ( w<sub>1</sub><sup>2</sup> - w<sub>2</sub><sup>2</sup> )</center>
<center>&delta;<sub>i</sub> = w<sub>i</sub> / ( w<sub>1</sub><sup>2</sup> - w<sub>2</sub><sup>2</sup> )</center>
And we have the following profits for firm i, <br>
<center>&pi;<sub>i</sub> = ( p<sub>i</sub> - c<sub>i</sub>) q<sub>i</sub></center>
As in our previous case we take the FOC, but with respect to p<sub>i</sub>.  In the symmmetric case we have that p<sub>i</sub> is, <br>
<center>p<sub>i</sub> = ( &alpha; - c<sub>i</sub>&delta;<sub>1</sub> )/ ( 2&delta;<sub>1</sub> - &delta;<sub>2</sub> )</center>
at the NE.  This is the case depisted in our graph of a continuous case Bertrand model and in our GAMS model.
</p>




<h2>
    Extended Mathematical programming(EMP) solvers
</h2>
<p>
    Knowing that the Cournot and Bertrand model can be solved as Nash Equilibrium and the Stackelberg model can be solved as bilevel problem. In both of the 2 cases, we can solved by writing down KKT conditions and then solve them as MCP or MOPEC. However, writing down those KKT conditions may be boring and tough work. Fortunately, we can use the "EMP" solver in GAMS to help do the transferation autlmatically by writing down the problem in equilibrium or bilevel form in the option files. This will largely reduce the work for programming.
</p>

<p>
    To see how these Euilibrium and Bilevel problems are actually solved. One can refer to <a href="static_emp2/Mathematical Programming with Equilibrium Constraints.md" target="_blank">here</a>
</p>



<a href="Input and Output specification"></a>

<h1>
    Input and Output Specification
</h1>

<h3>
    Input for Cournot and Stackelberg model
</h3>

<ul>
    <li>Cournot & Stackelberdg firms: The index of the firms for the Cournot and Stackelberg models.</li>
    <li>leader firm: The leader firm in the Stackelberg model. There should be exactly one leader firm chosen from the "Cournot & Stackelberdg firms" parameter.</li>
    <li>CES data form firms: Give the parameter in the CES function for each firm in the "Cournot & Stackelberdg firms". The index c stands for the unit cost of the firm, L stands for the labor coefficient , beta stands for the supply elasticity.</li>
    <li>gamma: Demand elasticity in the CES function</li>
    <li>dbar: Reference unit price demand</li>
</ul>

<h3>
    Input for Bertrand model
</h3>


<ul>
<li>dbert Unit reference demand for the Bertrand model</li>
<li>jdata:information of the firms in Bertrand model, containing:
c-unit cost,w-production quantity</li>
</ul>


<h3>
    Output for Cournot model
</h3>
<ul>
    <li>Cournot model result:Two profits-quantities curve that shows the variation of the profits of all firms w.r.t their quantities and w.r.t only the first firm's quantity. More details are explained in the output page. </li>
</ul>

<h3>
    Output for Stackelberg model
</h3>

<ul>
    <li>Difference between Cornot and Stackelberg model: A table comparing the result between when there is a leader firm and other firms will respond based on the leader firm's decision and when there is no leader firm and each firm will give the best response.</li>
    <li>lead firm info: The profits-quantity curves of the leader firm will make as a leader firm or not.</li>
    <li>nonleader firm info: profits-quantity of the leader firm curves of the other firms.</li>
</ul>

More explanantions about the figure will be shown on the output page.



<h3>
    Output for Bertrand model
</h3>

<ul>
    <li>Bertrand result: Two pictures. The first shows the quantities-price curves of the two firms as the price of the firm 1 varies. The second shows the profit-price curves of the two firms as the price of the firm 1 varies.</li>
    More explanations about the pictures will be shown on the output page.
</ul>


<h1>GAMS Model</h1>

 <a href="static_emp2/emo2.gms" target="_blank">Download GAMS model</a>


<h1>Acknoledgements</h1>
<p>
We would like to acknowledge the spectacular instruction we receive from the dedicated faculty at UW-Madison, with special acknowledgment of Prof. Jeffrey Linderoth, Prof. Michael Ferris, Prof. Thomas Rutherford and Prof. Marzena Rostek whose instruction directly informed this case study.
</p>


<h1>References</h1>
<p>
Dirkse, S P, and Ferris, M C, MCPLIB: A Collection of Nonlinear Mixed Complementarity Problems. Optimization Methods and Software 5 (1995), 319-345.
Engineering and Economic Applications of Complementarity Problems by M.C. Ferris, J.S. Pang (1997).
GAMS Model Library : nash.gms http://www.gams.com/modlib/libhtml/nash.htm 
GAMS Model Type Descriptions http://www.gams.com/modtype/modeltyp.htm 
M. C. Ferris and T. S. Munson. Complementarity problems in GAMS and the PATH solver. Journal of Economic Dynamics and Control, 24:165-188, 2000. 
M. C. Ferris and K. Sinapiromsaran. Formulating and solving nonlinear programs as mixed complementarity problems. In V.~H. Nguyen, J.~J. Strodiot, and P.~Tossings, editors, Optimization, volume 481 of Lecture Notes in Economics and Mathematical Systems. Springer-Verlag, 2000 
Ferris, Michael C., Mangasarian, Olvi L. and Wright, Stephen J., Linear Programming with MATLAB 
Leyffer S., Munson T. Solving Multi-Leader-Follower Games. Mathematics and Computer Science Division (2005) 
Lecture Notes on CES Utility by Thomas Rutherford http://www.gamsworld.eu/mpsge/debreu/ces.pdf 
Lecture : An Introduction to Complementarity by Michael Ferris  http://pages.cs.wisc.edu/~ferris/talks/aussois-intro.pdf 
Lecture : Complementarity Problems and Applications by Michael Ferris http://pages.cs.wisc.edu/~ferris/talks/StockholmEmbed.pdf 
Lecture : An Extended Mathematical Programming Framework by Michael Ferris  http://pages.cs.wisc.edu/~ferris/talks/berkeley.pdf 
Linear Complementarity, Linear and Nonlinear Programming by Katta G. Murty http://ioe.engin.umich.edu/people/fac/books/murty 
An Introduction to Game Theory by Martin J. Osbourne (2004) Oxford University Press, New York, Oxford
Microeconomic Analysis, Second Edition by Hal R. Varian, (1984) W.W. Norton & Company - University of Michigan 
T. Rutherford, Extension of GAMS for complementarity problems in applied economic analysis, (1994) Journal of Economic Dynamics & Control 
William H. Sandholm, Population Games and Evolutionary Dynamics (2010) The MIT Press, Cambridge, Massachusetts
</p>



