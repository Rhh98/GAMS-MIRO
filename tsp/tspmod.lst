GAMS 31.1.0  r55b6ce3 Released May  1, 2020 WEX-WEI x86 64bit/MS Windows - 07/04/20 13:34:33 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      TSP with Pataki modifications
   4  set city /
INCLUDE    C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\set.csv
   6  Montgomery_AL,Juneau_AK,Phoenix_AZ,Little-Rock_AR,Sacramento_CA,Denver_CO,Hartford_CT,Dover_DE,Tallahassee_FL,Atlanta_GA,Honolulu_HI,Boise_ID,Springfield_IL,Indianapolis_IN,Des-Moines_IA,Topeka_KS,Frankfort_KY,Baton-Rouge_LA,Augusta_ME,Annapolis_MD,
      Boston_MA,Lansing_MI,Saint-Paul_MN,Jackson_MS,Jefferson-City_MO,Helana_MT,Lincoln_NE,Carson-City_NV,Concord_NH,Trenton_NJ,Santa-Fe_NM,Albany_NY,Raleigh_NC,Bismarck_ND,Columbus_OH,Oklahoma-City_OK,Salem_OR,Harrisburg_PA,Providence_RI,Columbia_SC,Pier
      re_SD,Nashville_TN,Austin_TX,Salt-Lake-City_UT,Montpelier_VT,Richmond_VA,Olympia_WA,Charleston_WV,Madison_WI,Cheyenne_WY
   7  /
   8  ;
   9  alias(city,i,j);
  10  set Header /l_lat,l_long,select/;
  12  table CityInfo(city,Header)
INCLUDE    C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\capitals.csv
  15  ,l_lat,l_long,select
  16  Montgomery_AL,32.361538,-86.279118,1
  17  Juneau_AK,58.301935,-134.41974,0
  18  Phoenix_AZ,33.448457,-112.073844,1
  19  Little-Rock_AR,34.736009,-92.331122,1
  20  Sacramento_CA,38.555605,-121.468926,1
  21  Denver_CO,39.7391667,-104.984167,1
  22  Hartford_CT,41.767,-72.677,1
  23  Dover_DE,39.161921,-75.526755,1
  24  Tallahassee_FL,30.4518,-84.27277,1
  25  Atlanta_GA,33.76,-84.39,1
  26  Honolulu_HI,21.30895,-157.826182,0
  27  Boise_ID,43.613739,-116.237651,1
  28  Springfield_IL,39.78325,-89.650373,1
  29  Indianapolis_IN,39.790942,-86.147685,1
  30  Des-Moines_IA,41.590939,-93.620866,1
  31  Topeka_KS,39.04,-95.69,1
  32  Frankfort_KY,38.197274,-84.86311,1
  33  Baton-Rouge_LA,30.45809,-91.140229,1
  34  Augusta_ME,44.323535,-69.765261,1
  35  Annapolis_MD,38.972945,-76.501157,1
  36  Boston_MA,42.2352,-71.0275,1
  37  Lansing_MI,42.7335,-84.5467,1
  38  Saint-Paul_MN,44.95,-93.094,1
  39  Jackson_MS,32.32,-90.207,1
  40  Jefferson-City_MO,38.572954,-92.189283,1
  41  Helana_MT,46.595805,-112.027031,1
  42  Lincoln_NE,40.809868,-96.675345,1
  43  Carson-City_NV,39.160949,-119.753877,1
  44  Concord_NH,43.220093,-71.549127,1
  45  Trenton_NJ,40.221741,-74.756138,1
  46  Santa-Fe_NM,35.667231,-105.964575,1
  47  Albany_NY,42.659829,-73.781339,1
  48  Raleigh_NC,35.771,-78.638,1
  49  Bismarck_ND,46.813343,-100.779004,1
  50  Columbus_OH,39.962245,-83.000647,1
  51  Oklahoma-City_OK,35.482309,-97.534994,1
  52  Salem_OR,44.931109,-123.029159,1
  53  Harrisburg_PA,40.269789,-76.875613,1
  54  Providence_RI,41.82355,-71.422132,1
  55  Columbia_SC,34,-81.035,1
  56  Pierre_SD,44.367966,-100.336378,1
  57  Nashville_TN,36.165,-86.784,1
  58  Austin_TX,30.266667,-97.75,1
  59  Salt-Lake-City_UT,40.7547,-111.892622,1
  60  Montpelier_VT,44.26639,-72.57194,1
  61  Richmond_VA,37.54,-77.46,1
  62  Olympia_WA,47.042418,-122.893077,1
  63  Charleston_WV,38.349497,-81.633294,1
  64  Madison_WI,43.074722,-89.384444,1
  65  Cheyenne_WY,41.145548,-104.802042,1
  67  ;
  69  set select(city) Selected capitals;
  70  select(city)$(cityInfo(city,'select') eq 1)=yes;
  71  scalar count /0/;
  72  parameter OrderVal(i);
  73  loop(select,count=count+1;OrderVal(select)=count;);
  74   
  75  alias(select,k)
  76  table  dist(i,j)  "distances" ;
  77  dist(i,j)$(not sameas(i,j))=arccos(sin(cityInfo(i,'l_lat')*pi/180)*sin(cityInfo(j,'l_lat')*pi/180)
  78  +cos(cityInfo(i,'l_lat')*pi/180)*cos(cityInfo(j,'l_lat')*pi/180)*
  79  cos((cityInfo(j,'l_long')-cityInfo(i,'l_long'))*pi/180))*6371.004;
  80   
  81  binary variables x(i,j);
  82  free variable obj;
  83  positive variables u(i) ;
  84  equations defobj, assign1(j), assign2(i), mtz(i,j);
  85  defobj..
  86  obj =e= sum((select,k), dist(select,k) * x(select,k));
  87   
  88  assign1(select)..
  89  sum(k$(not sameas(select,k)), x(select,k)) =e= 1;
  90   
  91  assign2(select)..
  92  sum(k$(not sameas(select,k)), x(k,select)) =e= 1;
  93   
  94  mtz(select,k)$(OrderVal(select) ne 1 and OrderVal(k) ne 1 and not sameas(select,k))..
  95    u(select) - u(k) + 1 =L= (card(select) - 1) * (1 - x(select,k)) ;
  96   
  97  model tsp /defobj, assign1, assign2, mtz/;
  98   
  99  x.fx(select,select) = 0;
 100  u.lo(select) = 2; u.up(select) = card(i);
 101  u.fx(select)$(OrderVal(select) eq 1) = 1;
 102   
 103  option optcr = 0;
 107  tsp.optfile = 1;
 108  solve tsp using mip minimizing obj ;
 109  display obj.l;
 110  set tour(i,j) ;
 111   
 112  tour(select,select) = no;
 113  tour(select,k)$(x.l(select,k) > 0.01) = yes ;
 114  set TourHeader /status 'whether selected',dist 'distance',lat1 'latitude1',long1 'longitude1',lat2 'latitude2',long2 'longitude2'/;
 116  table TourT(i,j,TourHeader);
 117  TourT(select,k,'status')$tour(select,k)=1;
 118  TourT(i,j,'status')$(not tour(i,j))=-1;
 119  TourT(i,j,'dist')=dist(i,j);
 120  TourT(i,j,'lat1')=cityInfo(i,'l_lat');
 121  TourT(i,j,'long1')=cityInfo(i,'l_long');
 122  TourT(i,j,'lat2')=cityInfo(j,'l_lat');
 123  TourT(i,j,'long2')=cityInfo(j,'l_long');
 124  scalar TotalCost Total Cost;
 125  TotalCost=obj.l;
 127  * Just print the tour in a simple way
 128  option tour:0:0:1 ;
 129   
 130  display tour;
 131  display u.L;
GAMS 31.1.0  r55b6ce3 Released May  1, 2020 WEX-WEI x86 64bit/MS Windows - 07/04/20 13:34:33 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\tspmod.gms
     2        5 INCLUDE        1       5  .C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\set.csv
     3       14 INCLUDE        1      13  .C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\capitals.csv


COMPILATION TIME     =        0.016 SECONDS      3 MB  31.1.0 r55b6ce3 WEX-WEI


USER: CS526 Advanced Linear Programming              G200210/0001AS-GEN
      Course License UW-Madison, Prof Ferris, Spring 2020        DCE515
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\tspmod.gms
Output     C:\Users\hasee\Documents\GitHub\GAMS-MIRO\tsp\tspmod.lst
